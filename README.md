## Prerequisites
* `python`: 3.7.6
* `CUDA`: 10.1
* `pytorch`: 1.2.0

## Data

### *Data_song*
The source data of *Data_song* was provided in *./Data*.

The *test_NCP_ANF_encodingmatrix.npy*, *test_Word2vec_encodingmatrix.json*, and *valid_Word2vec_encodingmatrix.json* in *./Scripts* are input matrices generated by NCP, ANF, and Word2vec encoding methods, for example, a sapmle in the *test_NCP_ANF_encodingmatrix.npy* is a matrix of the RNA sequence generated by NCP and ANF.

The *test_encodingmatrix_index.json* and *valid_Word2vec_encodingmatrix.json* in *./Scripts* are samples indices of test set and valid set, respectively. This is done to facilitate data loaders loading the same batch of data in both branches.



## Test our model TransRNAm on the *DS<sub>_song</sub>*

Step 1: ```CD Scripts```

Step 2: ```python train.py --mode='test'  --use_embedding=True --weights='../Optimal_Model/Best_weights.pkl'```

## Train your own model on the *DS<sub>_song</sub>*

Step 1: ```CD Scripts```

Step 2: ```python train.py --mode='train' --use_embedding=True --epochs=10 --lr=0.0001 --batch_size=64```

## Generate attention_maps

Step 1: ```CD attention_map```

Step 2: ```run attn_map.ipynb```


